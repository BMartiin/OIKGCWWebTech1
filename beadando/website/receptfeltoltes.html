<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous"
    >

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <link rel="stylesheet" href="style.css">
    <title>Receptfeltöltés</title>
</head>
<body>
    <header class="hero-header">
        <div class="light-bar"></div>
        <div class="hero-inner">
            <h1 id="mainTitle">Receptfeltöltés</h1>
            <p id="subtitle">
                Oszd meg kedvenc receptjeidet az Ízemlékek közösségével!
            </p>
        </div>
    </header>

    <section class="container py-4">

        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="recipeFormCard">
                    <h2 class="formTitle mb-3">Új recept beküldése</h2>

                    <form id="recipeForm">
                        <!-- Recept alapadatok -->
                        <div class="row g-3 mb-3">
                            <div class="col-12 col-md-6">
                                <label for="recipeName" class="formLabel">Recept neve</label>
                                <input type="text" id="recipeName" class="formInput" placeholder="Pl.: Nagyi túrós csuszája" required>
                            </div>
                            <div class="col-12 col-md-6">
                                <label for="cuisine" class="formLabel">Nemzet konyhája</label>
                                <select id="cuisine" class="formInput">
                                    <option value="Magyar">Magyar</option>
                                    <option value="Olasz">Olasz</option>
                                    <option value="Francia">Francia</option>
                                    <option value="Ázsiai">Ázsiai</option>
                                    <option value="Amerikai">Amerikai</option>
                                    <option value="Egyéb">Egyéb</option>
                                </select>
                            </div>
                        </div>

                        <div class="row g-3 mb-3">
                            <div class="col-12 col-md-4">
                                <label for="prepTime" class="formLabel">Elkészítési idő (perc)</label>
                                <input type="number" min="1" id="prepTime" class="formInput" placeholder="Pl.: 45">
                            </div>
                            <div class="col-12 col-md-4">
                                <label for="priceCategory" class="formLabel">Árkategória</label>
                                <select id="priceCategory" class="formInput">
                                    <option value="Olcsó">Olcsó</option>
                                    <option value="Közepes">Közepes</option>
                                    <option value="Drága">Drága</option>
                                </select>
                            </div>
                            <div class="col-12 col-md-4">
                                <label for="dietType" class="formLabel">Étel típusa</label>
                                <select id="dietType" class="formInput">
                                    <option value="Hagyományos">Hagyományos</option>
                                    <option value="Vegetáriánus">Vegetáriánus</option>
                                    <option value="Vegán">Vegán</option>
                                    <option value="Laktózmentes">Laktózmentes</option>
                                    <option value="Gluténmentes">Gluténmentes</option>
                                </select>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- Hozzávalók -->
                        <h3 class="sectionTitle mb-2">Hozzávalók</h3>
                        <p class="small text-muted mb-2">
                            Írd be egyesével a hozzávalókat és a mennyiséget, majd kattints a <strong>„Hozzávaló hozzáadása”</strong> gombra.
                        </p>

                        <div class="row g-2 align-items-end mb-3">
                            <div class="col-12 col-md-6">
                                <label for="ingredientName" class="formLabel">Hozzávaló</label>
                                <input type="text" id="ingredientName" class="formInput" placeholder="Pl.: Liszt">
                            </div>
                            <div class="col-12 col-md-4">
                                <label for="ingredientQty" class="formLabel">Mennyiség</label>
                                <input type="text" id="ingredientQty" class="formInput" placeholder="Pl.: 20 dkg">
                            </div>
                            <div class="col-12 col-md-2 d-grid">
                                <button id="addIngredient" class="action_button" type="button">Hozzávaló hozzáadása</button>
                            </div>
                        </div>

                        <div class="ingredientsPreviewBox mb-4">
                            <h4 class="ingredientsTitle mb-2">Felvitt hozzávalók:</h4>
                            <ul id="ingredientsPreview" class="ingredientsList mb-0">
                                <!-- ide kerülnek dinamikusan az összegyűjtött hozzávalók -->
                            </ul>
                            <p id="noIngredientsMsg" class="text-muted small mb-0">
                                Még nem adtál hozzá hozzávalót.
                            </p>
                        </div>

                        <!-- Elkészítési leírás -->
                        <h3 class="sectionTitle mb-2">Elkészítés leírása</h3>
                        <div class="mb-4">
                            <label for="instructions" class="formLabel">Lépések, tippek, trükkök</label>
                            <textarea id="instructions" class="formInput" rows="6" placeholder="Írd le lépésről lépésre, hogyan készül a fogás..." required></textarea>
                        </div>

                        <!-- Submit gomb -->
                        <div class="text-center">
                            <button type="submit" class="action_button submitRecipeBtn">
                                Recept beküldése / előnézet
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Eredmény táblázat -->
        <div class="row justify-content-center mt-4">
            <div class="col-12 col-lg-10">
                <div id="recipeResultCard" class="recipeResultCard d-none">
                    <h2 class="formTitle mb-3">Recept előnézet</h2>
                    <p class="mb-3 small text-muted">
                        Az alábbi táblázatban láthatod az általad megadott adatokat összefoglalva.
                    </p>
                    <div class="table-responsive">
                        <table class="table table-striped align-middle">
                            <thead>
                                <tr>
                                    <th>Recept neve</th>
                                    <th>Nemzet konyhája</th>
                                    <th>Elkészítési idő</th>
                                    <th>Árkategória</th>
                                    <th>Étel típusa</th>
                                    <th>Hozzávalók</th>
                                    <th>Elkészítés leírása</th>
                                </tr>
                            </thead>
                            <tbody id="recipeResultBody">
                                <!-- ide generáljuk a sort JS-ből -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <a href="index.html" class="back-home-btn">
        ⟵ Vissza a főoldalra
        </a>

    </section>

    <footer>
        <p class="mb-0" id="footer_stuff">
            <i>© 2025 Miskolci Egyetem - Balogh Martin OIKGCW - Webtechnológia - Bednarik László</i>
        </p>
    </footer>

    <!-- jQuery header animációk -->
    <script>
      $(document).ready(function () {
        // Cím becsúsztatása + halványítás
        $("#mainTitle")
          .css({
            opacity: 0,
            top: "-20px",
            position: "relative"
          })
          .animate({
            opacity: 1,
            top: "0px"
          }, 800);

        // Alcím késleltetve jelenik meg
        $("#subtitle")
          .css({ opacity: 0 })
          .delay(400)
          .animate({ opacity: 1 }, 800);

        // Fénycsík folyamatos animációja
        function animateLightBar() {
          $(".light-bar")
            .css({ left: "-40%" })
            .animate({ left: "110%" }, 2000, "swing", function () {
              setTimeout(animateLightBar, 1200);
            });
        }

        animateLightBar();
      });
    </script>

    <!-- Recept űrlap logika -->
    <script>
      $(function () {
        let ingredients = [];

        function renderIngredients() {
          const $list = $("#ingredientsPreview");
          const $emptyMsg = $("#noIngredientsMsg");

          $list.empty();

          if (ingredients.length === 0) {
            $emptyMsg.show();
            return;
          }

          $emptyMsg.hide();

          ingredients.forEach(function (ing) {
            const li = $("<li></li>").text(ing.name + " – " + ing.qty);
            $list.append(li);
          });
        }

        $("#addIngredient").on("click", function () {
          const name = $("#ingredientName").val().trim();
          const qty = $("#ingredientQty").val().trim();

          if (!name || !qty) {
            alert("Kérlek add meg a hozzávaló nevét és mennyiségét is!");
            return;
          }

          ingredients.push({ name, qty });
          $("#ingredientName").val("");
          $("#ingredientQty").val("");
          renderIngredients();
        });

        $("#recipeForm").on("submit", function (e) {
          e.preventDefault();

          const recipeName = $("#recipeName").val().trim();
          const cuisine = $("#cuisine").val();
          const prepTime = $("#prepTime").val().trim();
          const priceCategory = $("#priceCategory").val();
          const dietType = $("#dietType").val();
          const instructions = $("#instructions").val().trim();

          if (!recipeName || !instructions) {
            alert("A recept neve és az elkészítés leírása kötelező!");
            return;
          }

          if (ingredients.length === 0) {
            if (!confirm("Még nem adtál hozzá hozzávalót. Biztosan folytatod?")) {
              return;
            }
          }

          const ingredientsHtml = ingredients.length
            ? "<ul class='mb-0'>" + ingredients.map(i => "<li>" + i.name + " – " + i.qty + "</li>").join("") + "</ul>"
            : "<em>Nincs megadva</em>";

          const timeText = prepTime ? prepTime + " perc" : "Nincs megadva";

          const rowHtml = `
            <tr>
              <td>${recipeName}</td>
              <td>${cuisine}</td>
              <td>${timeText}</td>
              <td>${priceCategory}</td>
              <td>${dietType}</td>
              <td>${ingredientsHtml}</td>
              <td style="max-width: 320px; white-space: pre-wrap;">${instructions}</td>
            </tr>
          `;

          $("#recipeResultBody").html(rowHtml);
          $("#recipeResultCard").removeClass("d-none");
          // görgessünk le az előnézethez
          $("html, body").animate({
            scrollTop: $("#recipeResultCard").offset().top - 80
          }, 600);
        });
      });
    </script>

</body>
</html>
