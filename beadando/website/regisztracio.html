<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <link rel="stylesheet" href="style.css">
  <title>√çzeml√©k ‚Äì Regisztr√°ci√≥</title>
</head>
<body>
  <!-- HEADER K√âP -->
  <header>
    <img src="header.jpg" alt="Header" class="header-hero">
  </header>

  <section class="container py-4">
    <div class="row g-3">
      <!-- Bevezet≈ë -->
      <div class="col-12">
        <div class="pageIntro d-flex flex-column align-items-center justify-content-center h-100 text-center">
          <h1 class="title mb-3">Regisztr√°ci√≥</h1>
          <p class="normLet">
            Hozd l√©tre saj√°t √çzeml√©k fi√≥kodat, mentsd el kedvenc receptjeidet, 
            √©s oszd meg a saj√°t √≠zeml√©keidet m√°sokkal! üòä
          </p>
        </div>
      </div>

      <!-- Regisztr√°ci√≥s ≈±rlap -->
      <div class="col-12 col-md-10 col-lg-8 mx-auto">
        <div class="formCard">
          <h2 class="formTitle mb-3">Regisztr√°ci√≥s adatok</h2>

          <form id="regForm" novalidate>
            <!-- Teljes n√©v -->
            <div class="formRow">
              <label for="name" class="formLabel">Teljes n√©v</label>
              <input type="text" id="name" name="name" class="formInput" placeholder="Pl.: Kiss Anna" required>
              <small class="errorMsg" id="nameError"></small>
            </div>

            <!-- Felhaszn√°l√≥n√©v -->
            <div class="formRow">
              <label for="username" class="formLabel">Felhaszn√°l√≥n√©v</label>
              <input type="text" id="username" name="username" class="formInput" placeholder="Pl.: izemlek_rajongo" required>
              <small class="errorMsg" id="usernameError"></small>
            </div>

            <!-- E-mail -->
            <div class="formRow">
              <label for="email" class="formLabel">E-mail c√≠m</label>
              <input type="email" id="email" name="email" class="formInput" placeholder="valami@pelda.hu" required>
              <small class="errorMsg" id="emailError"></small>
            </div>

            <!-- Jelsz√≥ -->
            <div class="formRow">
              <label for="password" class="formLabel">Jelsz√≥</label>
              <input type="password" id="password" name="password" class="formInput" placeholder="Min. 6 karakter, legyen benne sz√°m is" required>
              <small class="errorMsg" id="passwordError"></small>
            </div>

            <!-- Jelsz√≥ ism√©t -->
            <div class="formRow">
              <label for="password2" class="formLabel">Jelsz√≥ ism√©t</label>
              <input type="password" id="password2" name="password2" class="formInput" placeholder="Ism√©teld meg a jelsz√≥t" required>
              <small class="errorMsg" id="password2Error"></small>
            </div>

            <!-- Sz√ºlet√©si d√°tum -->
            <div class="formRow">
              <label for="birthdate" class="formLabel">Sz√ºlet√©si d√°tum</label>
              <input type="date" id="birthdate" name="birthdate" class="formInput">
              <small class="errorMsg" id="birthdateError"></small>
            </div>

            <!-- Heti h√°ny alkalommal f≈ëz√∂l -->
            <div class="formRow">
              <label for="cookfreq" class="formLabel">Heti h√°ny alkalommal f≈ëz√∂l?</label>
              <input
                type="number"
                id="cookfreq"
                name="cookfreq"
                class="formInput"
                min="0"
                max="21"
                placeholder="Pl.: 3"
              >
              <small class="errorMsg" id="cookfreqError"></small>
            </div>

            <!-- Kedvenc sz√≠n az √©telekben -->
            <div class="formRow">
              <label for="favcolor" class="formLabel">Melyik sz√≠nt szereted a legjobban az √©telekben?</label>
              <input type="color" id="favcolor" name="favcolor" class="formInput" value="#fe4a49">
            </div>

            <!-- F≈ëz√©si szint (r√°di√≥) -->
            <div class="formRow">
              <span class="formLabel d-block mb-1">F≈ëz√©si szinted</span>
              <div class="formCheck">
                <label>
                  <input type="radio" name="skill" value="kezdo"> Kezd≈ë
                </label>
              </div>
              <div class="formCheck">
                <label>
                  <input type="radio" name="skill" value="halado"> Halad√≥
                </label>
              </div>
              <div class="formCheck">
                <label>
                  <input type="radio" name="skill" value="profi"> Profi
                </label>
              </div>
              <small class="errorMsg" id="skillError"></small>
            </div>

            <!-- Kedvenc konyhat√≠pus (select) -->
            <div class="formRow">
              <label for="kitchen" class="formLabel">Kedvenc konyhat√≠pus</label>
              <select id="kitchen" name="kitchen" class="formInput">
                <option value="">V√°lassz...</option>
                <option value="magyar">Magyar</option>
                <option value="olasz">Olasz</option>
                <option value="√°zsiai">√Åzsiai</option>
                <option value="mexik√≥i">Mexik√≥i</option>
                <option value="egy√©b">Egy√©b / vegyes</option>
              </select>
            </div>

            <!-- Kedvenc alapanyag (datalist) -->
            <div class="formRow">
              <label for="favIngredient" class="formLabel">Kedvenc alapanyagod</label>
              <input list="alapanyagok" id="favIngredient" name="favIngredient" class="formInput" placeholder="Pl.: fokhagyma">
              <datalist id="alapanyagok">
                <option value="Fokhagyma">
                <option value="Hagyma">
                <option value="Paradicsom">
                <option value="Csirkeh√∫s">
                <option value="Sajt">
              </datalist>
            </div>

            <!-- R√∂vid bemutatkoz√°s (textarea) -->
            <div class="formRow">
              <label for="about" class="formLabel">R√∂viden magadr√≥l</label>
              <textarea id="about" name="about" rows="4" class="formInput" placeholder="√çrd le p√°r mondatban, milyen √≠zeket szeretsz, mi√≥ta f≈ëz√∂l..."></textarea>
            </div>

            <!-- Checkboxok -->
            <div class="formRow formRow-inline">
              <label class="formCheck">
                <input type="checkbox" id="terms" name="terms">
                <span>Elfogadom az adatkezel√©si t√°j√©koztat√≥t</span>
              </label>
              <small class="errorMsg" id="termsError"></small>
            </div>

            <div class="formRow formRow-inline">
              <label class="formCheck">
                <input type="checkbox" id="newsletter" name="newsletter">
                <span>Szeretn√©k h√≠rlevelet kapni az √∫j receptekr≈ël</span>
              </label>
            </div>

            <!-- Gomb -->
            <div class="formRow text-center mt-3">
              <button type="submit" class="action_button">
                Regisztr√°ci√≥ elk√ºld√©se
              </button>
            </div>

            <!-- Visszajelz√©s -->
            <p id="formMessage" class="formMessage mt-3"></p>
          </form>
        </div>
      </div>

      <!-- JSON el≈ën√©zet (dem√≥) -->
      <div class="col-12 col-md-10 col-lg-8 mx-auto mt-3">
        <div class="jsonPreviewCard">
          <h3 class="jsonTitle">Bek√ºld√∂tt adatok (JSON form√°tumban ‚Äì dem√≥)</h3>
          <pre id="jsonPreview" class="jsonPreview">// Itt fog megjelenni a JSON, ha a regisztr√°ci√≥ sikeres.</pre>
        </div>
      </div>

    </div>

    <!-- Vissza a f≈ëoldalra gomb -->
    <a href="index.html" class="back-home-btn">
      ‚üµ Vissza a f≈ëoldalra
    </a>

  </section>

  <footer class="container py-3">
    <p class="mb-0" id="footer_stuff">
      <i>¬© 2025 Miskolci Egyetem - Balogh Martin OIKGCW - Webtechnol√≥gia - Bednarik L√°szl√≥</i>
    </p>
  </footer>

  <!-- Regisztr√°ci√≥s JS + JSON -->
  <script>
    const regForm         = document.getElementById('regForm');

    const nameInput       = document.getElementById('name');
    const usernameInput   = document.getElementById('username');
    const emailInput      = document.getElementById('email');
    const passwordInput   = document.getElementById('password');
    const password2Input  = document.getElementById('password2');
    const birthdateInput  = document.getElementById('birthdate');
    const cookfreqInput   = document.getElementById('cookfreq');
    const favcolorInput   = document.getElementById('favcolor');
    const kitchenSelect   = document.getElementById('kitchen');
    const favIngredient   = document.getElementById('favIngredient');
    const aboutTextarea   = document.getElementById('about');
    const termsCheck      = document.getElementById('terms');
    const newsletterCheck = document.getElementById('newsletter');

    const nameError       = document.getElementById('nameError');
    const usernameError   = document.getElementById('usernameError');
    const emailError      = document.getElementById('emailError');
    const passwordError   = document.getElementById('passwordError');
    const password2Error  = document.getElementById('password2Error');
    const birthdateError  = document.getElementById('birthdateError');
    const cookfreqError   = document.getElementById('cookfreqError');
    const skillError      = document.getElementById('skillError');
    const termsError      = document.getElementById('termsError');

    const formMessage     = document.getElementById('formMessage');
    const jsonPreview     = document.getElementById('jsonPreview');

    // ===== KORL√ÅTOK BE√ÅLL√çT√ÅSA (SZ√úL. D√ÅTUM, F≈êZ√âSSZ√ÅM) =====

    // Sz√ºlet√©si d√°tum max = mai nap (HTML szinten is)
    if (birthdateInput) {
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      const todayStr = `${yyyy}-${mm}-${dd}`;
      birthdateInput.setAttribute('max', todayStr);
    }

    // Heti f≈ëz√©ssz√°m: input k√∂zben clamp 0‚Äì21 k√∂z√©
    if (cookfreqInput) {
      cookfreqInput.addEventListener('input', () => {
        if (cookfreqInput.value === '') return;
        let n = Number(cookfreqInput.value);
        if (isNaN(n)) {
          cookfreqInput.value = '';
          return;
        }
        if (n < 0) n = 0;
        if (n > 21) n = 21;
        cookfreqInput.value = n;
      });
    }

    // ===== VALID√ÅCI√ì =====

    function clearErrors() {
      [
        nameError, usernameError, emailError, passwordError,
        password2Error, birthdateError, cookfreqError,
        skillError, termsError
      ].forEach(el => { if (el) el.textContent = ''; });

      document.querySelectorAll('.formInput, .formCheck input')
        .forEach(el => el.classList.remove('input-error'));

      formMessage.textContent = '';
      formMessage.classList.remove('ok','error');
    }

    function validateEmail(email) {
      const pattern = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;
      return pattern.test(email);
    }

    regForm.addEventListener('submit', function(e) {
      e.preventDefault();

      clearErrors();
      let isValid = true;

      // N√©v
      if (!nameInput.value.trim()) {
        nameError.textContent = 'A n√©v megad√°sa k√∂telez≈ë.';
        nameInput.classList.add('input-error');
        isValid = false;
      }

      // Felhaszn√°l√≥n√©v
      if (!usernameInput.value.trim()) {
        usernameError.textContent = 'A felhaszn√°l√≥n√©v megad√°sa k√∂telez≈ë.';
        usernameInput.classList.add('input-error');
        isValid = false;
      } else if (!/^[a-zA-Z0-9_]{3,}$/.test(usernameInput.value.trim())) {
        usernameError.textContent = 'Legal√°bb 3 karakter, csak bet≈±, sz√°m, al√°h√∫z√°s.';
        usernameInput.classList.add('input-error');
        isValid = false;
      }

      // Email
      if (!emailInput.value.trim()) {
        emailError.textContent = 'Az e-mail megad√°sa k√∂telez≈ë.';
        emailInput.classList.add('input-error');
        isValid = false;
      } else if (!validateEmail(emailInput.value.trim())) {
        emailError.textContent = 'K√©rlek √©rv√©nyes e-mail c√≠met adj meg.';
        emailInput.classList.add('input-error');
        isValid = false;
      }

      // Jelsz√≥
      const pwd = passwordInput.value;
      if (!pwd) {
        passwordError.textContent = 'A jelsz√≥ megad√°sa k√∂telez≈ë.';
        passwordInput.classList.add('input-error');
        isValid = false;
      } else if (pwd.length < 6 || !/\d/.test(pwd)) {
        passwordError.textContent = 'Min. 6 karakter, √©s tartalmazzon sz√°mot is.';
        passwordInput.classList.add('input-error');
        isValid = false;
      }

      // Jelsz√≥ ism√©t
      if (!password2Input.value) {
        password2Error.textContent = 'K√©rlek ism√©teld meg a jelsz√≥t.';
        password2Input.classList.add('input-error');
        isValid = false;
      } else if (passwordInput.value !== password2Input.value) {
        password2Error.textContent = 'A k√©t jelsz√≥ nem egyezik.';
        password2Input.classList.add('input-error');
        isValid = false;
      }

      // Sz√ºlet√©si d√°tum ‚Äì opcion√°lis, de ha van, ne legyen j√∂v≈ëbeli
      if (birthdateInput.value) {
        const selected = new Date(birthdateInput.value);
        const today = new Date();
        // csak a d√°tum r√©szt hasonl√≠tjuk (id≈ë n√©lk√ºl)
        selected.setHours(0,0,0,0);
        today.setHours(0,0,0,0);

        if (selected > today) {
          birthdateError.textContent = 'A sz√ºlet√©si d√°tum nem lehet a j√∂v≈ëben.';
          birthdateInput.classList.add('input-error');
          isValid = false;
        }
      }

      // Heti f≈ëz√©ssz√°m ‚Äì opcion√°lis, de ha van, 0‚Äì21
      if (cookfreqInput.value) {
        const n = Number(cookfreqInput.value);
        if (isNaN(n) || n < 0 || n > 21) {
          cookfreqError.textContent = '0 √©s 21 k√∂z√∂tti sz√°mot adj meg.';
          cookfreqInput.classList.add('input-error');
          isValid = false;
        }
      }

      // F≈ëz√©si szint ‚Äì k√∂telez≈ë
      const skillChecked = document.querySelector('input[name="skill"]:checked');
      if (!skillChecked) {
        skillError.textContent = 'V√°laszd ki a f≈ëz√©si szintedet.';
        isValid = false;
      }

      // Adatkezel√©s elfogad√°sa
      if (!termsCheck.checked) {
        termsError.textContent = 'A regisztr√°ci√≥hoz el kell fogadnod az adatkezel√©st.';
        termsCheck.classList.add('input-error');
        isValid = false;
      }

      if (!isValid) {
        formMessage.textContent = 'K√©rlek jav√≠tsd a pirossal jelzett hib√°kat.';
        formMessage.classList.add('error');
        return;
      }

      // Ha minden ok√©: JSON objektum (jelsz√≥ NEM ker√ºl bele)
      const userData = {
        nev: nameInput.value.trim(),
        felhasznalonev: usernameInput.value.trim(),
        email: emailInput.value.trim(),
        szuletesiDatum: birthdateInput.value || null,
        hetiFozes: cookfreqInput.value ? Number(cookfreqInput.value) : null,
        kedvencSzin: favcolorInput.value,
        fozesiSzint: skillChecked ? skillChecked.value : null,
        kedvencKonyha: kitchenSelect.value || null,
        kedvencAlapanyag: favIngredient.value.trim() || null,
        bemutatkozas: aboutTextarea.value.trim() || null,
        hirlevelFeliratkozas: newsletterCheck.checked,
        regDatum: new Date().toISOString()
      };

      const jsonStr = JSON.stringify(userData, null, 2);

      formMessage.textContent = 'Sikeres ‚Äúvirtu√°lis‚Äù regisztr√°ci√≥ ‚Äì l√°sd a JSON-t lent ‚ò∫';
      formMessage.classList.add('ok');

      jsonPreview.textContent = jsonStr;
      // regForm.reset();  // ha √ºr√≠teni akarod a formot, vedd ki a kommentet
    });
  </script>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>
</body>
</html>
